# Домашнее задание недели 1

## Общие пояснения

Сслыка на урок и текст ДЗ: https://f213.notion.site/1-4-e4e0c4d4a0c847ea9158a0950d1ea596
Ссылка на ТЗ для системы: https://f213.notion.site/14ccbfaca5ae4844a44dfffed1173b6c

Отправной точкой стало выполнение Event Storming. В процессе начал появляться общий словарь терминов, зафиксировал его на доске https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366722790280&cot=14. Достаточно быстро выяснилось, что требования из ТЗ для домашки плохо накладываются на процесс ES, потому что значитальная часть требований относится к методикам расчета и интерфейсам, а не событиям в системе. Поэтому проектирование велось из общей логики работы таких систем. Достаточно быстро стало понятно, что аккаунтинг нужно выделять в отдельный домен из-за большого количества специфичных для него определений (хотя с точки зрения процесса работы он сильно завязан на таск трекер).

![Event Storming - Glossary](https://user-images.githubusercontent.com/133118/139596765-e308445e-e83e-4d85-a4f4-da7c3f4589e9.jpg)

**ОСНОВНАЯ ИДЕЯ**: за исключением синхронной авторизации, все коммуникации удалось спроектировать асинхронно. Для расчета начислений и списаний с попугов используются события, которые в себе содержат все необходимые данные о задаче (включая слепок заголовка/описания задачи для сохранения в аудитологе). Отчеты в сервисе аналитики строятся на основе пришедших за день, преобразованных и уложенных в time-series db данных, без отдельного вызова сериса аккаунтинга за счет использования _Event-Carried State Transfer strategy_.


## Задача 1

> Разобрать каждое требование на составляющие (актор, команда, событие, query). Определить, как все бизнес цепочки будут выглядеть и на какие шаги они будут разбиваться.

Требования разбиты на цепочки по методологии Event Storming. Результаты находятся в доске Miro: https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366722121098&cot=14

![Event Storming - Event Storming](https://user-images.githubusercontent.com/133118/139596679-98ab0bf0-0bc8-4325-8322-b5c29267f635.jpg)


## Задача 2

> Построить модель данных для системы и модель доменов. Рисовать можно в любом удобном инструменте (включая обычную бумагу), главное, чтобы это было не только у вас в голове, но и где-то вовне. Благодаря этому вы сможете сфокусироваться на отдельной части системы, не думая о других. А также показать свое решение одногрупникам/коллегам.

Высокоуровневое описание модели данных с взаимосвязями находится в доске Miro: https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366722903490&cot=14

![Event Storming - Data model](https://user-images.githubusercontent.com/133118/139596690-53b0820f-2004-4146-90a0-0fcd86ba8a0b.jpg)


## Задача 3

> Определить, какие общие данные нужны для разных доменов и как связаны данные между разными доменами.

Взаимосвязи между доменами и процесс обмена данными описан в доске Miro: https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366722903490&cot=14

Общие данные – авторизационная информация.

Остальные данные можно посылать вместе с payload событий, потому что фиксироваться они должны на момент возникновения события.

![Event Storming - Data model](https://user-images.githubusercontent.com/133118/139596710-d2a5429e-340a-427d-97f8-46fae9de67af.jpg)


## Задача 4

> Разобраться, какие сервисы, кроме тудушника, будут в нашей системе и какие между ними могут быть связи (как синхронные, так и асинхронные).

Набор сервисов соответствует набору доменом (1 сервис – 1 домен) и представляет собой следующий набор:

* Auth service –> домен авторизации и управления пользователями
* Task tracker service –> домен управления задачами
* Accounting service –> домен аккаунтинга
* Analytics servic –> домен аналитики

Взаимосвязи между сервисами показаны на доске https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366724638819&cot=14. Синхронная связь только одна – получение авторизационной информации из сервиса авторизации другими сервисами. Остальные связи асинхронные, на основе событий, проходящих через брокер событий.

![Event Storming - Services and dependencies](https://user-images.githubusercontent.com/133118/139596716-74f1cb56-b189-4968-8146-19796ee308bb.jpg)


## Задача 5

> Определить все бизнес события, необходимые для работы системы. Отобразить кто из сервисов является продьюсером, а кто консьюмером бизнес событий.

Список всех бизнес событий отображен на доске https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366724545523&cot=14. Бизнес события помечены желтыми карточками. По большей части события потребляются сервисами внутри самих себя, связей между разными сервисами сравнительно не много.

![Event Storming - Business and CUD events](https://user-images.githubusercontent.com/133118/139596721-1635ddc9-0712-49d7-b1b7-aeef3de42e80.jpg)


## Задача 6

> Выписать все CUD события и какие данные нужны для этих событий, которые необходимы для работы системы. Отобразить кто из сервисов является продьюсером, а кто консьюмером CUD событий.

Список всех бизнес событий отображен на доске https://miro.com/app/board/o9J_lmyjgP8=/?moveToWidget=3074457366724545523&cot=14. CUD события помечены оранжевыми карточками. По большей части события потребляются сервисами внутри самих себя, связей между разными сервисами сравнительно не много.

![Event Storming - Business and CUD events](https://user-images.githubusercontent.com/133118/139596726-ee1cc949-abb3-468c-8b99-ad1ddb397111.jpg)

